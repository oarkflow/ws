{
    "anomalyDetectionRules": {
        "global": {
            "ddosDetection": {
                "enabled": true,
                "threshold": {
                    "requestsPerMinute": 100
                },
                "actions": [
                    {
                        "type": "rate_limit",
                        "limit": "50 rpm",
                        "response": {
                            "status": 429,
                            "message": "Too many global requests. Please slow down."
                        }
                    },
                    {
                        "type": "temporary_ban",
                        "duration": "10m",
                        "response": {
                            "status": 403,
                            "message": "Temporary ban due to suspected DDoS activity."
                        }
                    }
                ]
            },
            "mitmDetection": {
                "enabled": true,
                "indicators": [
                    "invalid_ssl_certificate",
                    "abnormal_tls_handshake",
                    "suspicious_user_agent"
                ],
                "actions": [
                    {
                        "type": "permanent_ban",
                        "response": {
                            "status": 403,
                            "message": "Connection blocked due to security concerns (MITM detected)."
                        }
                    }
                ]
            }
        },
        "apiEndpoints": {
            "/api/login": {
                "rateLimit": {
                    "requestsPerMinute": 5,
                    "burst": 2
                },
                "actions": [
                    {
                        "type": "jitter_warning",
                        "jitterRangeMs": [ 500, 2000 ],
                        "response": {
                            "status": 429,
                            "message": "Too many login attempts. Please wait a moment."
                        }
                    },
                    {
                        "type": "temporary_ban",
                        "duration": "15m",
                        "trigger": {
                            "key": "failedLogins",
                            "threshold": 5,
                            "within": "2m"
                        },
                        "response": {
                            "status": 403,
                            "message": "You are temporarily banned due to excessive failed logins."
                        }
                    }
                ]
            },
            "/api/data/export": {
                "rateLimit": {
                    "requestsPerMinute": 3
                },
                "actions": [
                    {
                        "type": "rate_limit",
                        "limit": "3 rpm",
                        "response": {
                            "status": 429,
                            "message": "Rate limit exceeded for data export API."
                        }
                    },
                    {
                        "type": "jitter_warning",
                        "jitterRangeMs": [ 1000, 5000 ],
                        "response": {
                            "status": 429,
                            "message": "You are making export requests too frequently."
                        }
                    }
                ]
            }
        }
    }
}
